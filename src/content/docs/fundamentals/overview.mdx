---
title: Fundamentals Overview
description: Learn the core concepts of Visual Studio extensibility including services, packages, and commands.
category: fundamentals
order: 1
---

import Callout from '@components/Callout.astro';

This section covers the fundamental building blocks of Visual Studio extensions. Understanding these concepts is essential for building robust, well-integrated extensions.

## Core Concepts

### Visual Studio Architecture

Visual Studio is built on several key technologies:

- **COM (Component Object Model)** - The foundation of VS interoperability
- **MEF (Managed Extensibility Framework)** - Editor and component composition
- **Services** - Singleton objects providing IDE functionality
- **Packages** - Extension containers that register with VS

### The Service Model

Visual Studio exposes functionality through services:

```csharp
// Getting a service with Community Toolkit
var solution = await VS.Solutions.GetCurrentSolutionAsync();

// Getting a service the traditional way
var dte = await ServiceProvider.GetServiceAsync(typeof(DTE)) as DTE2;
```

Services follow the **Service Locator** pattern - you request services by type, and VS provides the implementation.

<Callout type="note">
Services are typically singletons scoped to the VS instance. Multiple extensions share the same service instances.
</Callout>

### Packages

A package is your extension's entry point:

```csharp
[PackageRegistration(UseManagedResourcesOnly = true, AllowsBackgroundLoading = true)]
[Guid("your-package-guid")]
public sealed class MyPackage : AsyncPackage
{
    protected override async Task InitializeAsync(
        CancellationToken cancellationToken,
        IProgress<ServiceProgressData> progress)
    {
        // Initialize your extension
    }
}
```

Packages:
- Register commands, tool windows, and services
- Handle initialization and cleanup
- Can auto-load in specific contexts

### Commands

Commands are user-invokable actions:

```csharp
[Command(PackageIds.MyCommand)]
internal sealed class MyCommand : BaseCommand<MyCommand>
{
    protected override async Task ExecuteAsync(OleMenuCmdEventArgs e)
    {
        // Command logic here
    }
}
```

Commands can be placed in:
- Menus (File, Edit, Tools, etc.)
- Toolbars
- Context menus
- The Command Window

## What You'll Learn

This section covers:

| Topic | Description |
|-------|-------------|
| [Service Provider](/docs/fundamentals/service-provider) | Accessing VS services |
| [Packages](/docs/fundamentals/packages) | Creating and configuring packages |
| [Commands](/docs/fundamentals/commands) | Adding menu commands |
| [Tool Windows](/docs/fundamentals/tool-windows) | Creating dockable panels |
| [Editors](/docs/fundamentals/editors) | Extending the code editor |
| [Options Pages](/docs/fundamentals/options-pages) | Adding settings pages |
| [Async Services](/docs/fundamentals/async-services) | Background loading patterns |

## Threading Model

Visual Studio has strict threading requirements:

- **Main thread** - UI operations, COM calls, most VS APIs
- **Background threads** - Long-running operations

```csharp
// Switch to main thread when needed
await ThreadHelper.JoinableTaskFactory.SwitchToMainThreadAsync();

// Or with Community Toolkit
await VS.ThreadHelper.JoinableTaskFactory.SwitchToMainThreadAsync();
```

<Callout type="warning">
Calling VS APIs from background threads can cause hangs or crashes. Always switch to the main thread for VS operations.
</Callout>

## Community Toolkit vs Traditional APIs

The **Community.VisualStudio.Toolkit** simplifies common tasks:

| Traditional | Community Toolkit |
|-------------|-------------------|
| `IVsUIShell.ShowMessageBox()` | `VS.MessageBox.ShowAsync()` |
| `IVsSolution.GetSolutionInfo()` | `VS.Solutions.GetCurrentSolutionAsync()` |
| Custom command plumbing | `BaseCommand<T>` |
| Manual service provider | `VS.GetServiceAsync<T>()` |

We use the Community Toolkit throughout this guide, but show traditional APIs where relevant.

## Next Steps

Start with [Service Provider](/docs/fundamentals/service-provider) to learn how to access Visual Studio's services.
